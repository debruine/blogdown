<!DOCTYPE html><html lang="en-us" >

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.3.0 for Hugo" />
  

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Lisa DeBruine" />

  
  
  
    
  
  <meta name="description" content="I saw this a few days ago and sympathised, because I’ve often wanted to use data that is trapped in images or PDFs. If it’s not too much, I’ll manually transcribe it, but that’s so tedious!" />

  
  <link rel="alternate" hreflang="en-us" href="https://debruine.github.io/post/data-from-images/" />

  









  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    <meta name="theme-color" content="#1565c0" />
  

  
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.f1ecf783c14edc00c9320c205831ad8e.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.2/css/academicons.min.css" integrity="sha512-KlJCpRsLf+KKu2VQa5vmRuClRFjxc5lXO03ixZt82HZUk41+1I0bD8KBSA0fY290ayMfWYI9udIqeOWSu1/uZg==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      
        
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.b1dff6f85aae5097c42eda0896577563.css" />

  




<script async src="https://www.googletagmanager.com/gtag/js?id=G-16Q0LBRCV4"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'G-16Q0LBRCV4', {});
  gtag('set', {'cookie_flags': 'SameSite=None;Secure'});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  

  

  




  
  
  

  

  
    <link rel="manifest" href="/manifest.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hud41de7153c7fa400a999f8d222dc5c78_8091_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hud41de7153c7fa400a999f8d222dc5c78_8091_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="https://debruine.github.io/post/data-from-images/" />

  
  
  
  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary" />
  
    <meta property="twitter:site" content="@@lisadebruine" />
    <meta property="twitter:creator" content="@@lisadebruine" />
  
  <meta property="og:site_name" content="Lisa DeBruine" />
  <meta property="og:url" content="https://debruine.github.io/post/data-from-images/" />
  <meta property="og:title" content="Data from Images | Lisa DeBruine" />
  <meta property="og:description" content="I saw this a few days ago and sympathised, because I’ve often wanted to use data that is trapped in images or PDFs. If it’s not too much, I’ll manually transcribe it, but that’s so tedious!" /><meta property="og:image" content="https://debruine.github.io/media/icon_hud41de7153c7fa400a999f8d222dc5c78_8091_512x512_fill_lanczos_center_3.png" />
    <meta property="twitter:image" content="https://debruine.github.io/media/icon_hud41de7153c7fa400a999f8d222dc5c78_8091_512x512_fill_lanczos_center_3.png" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2021-10-17T00:00:00&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2021-10-17T11:22:13&#43;01:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://debruine.github.io/post/data-from-images/"
  },
  "headline": "Data from Images",
  
  "datePublished": "2021-10-17T00:00:00Z",
  "dateModified": "2021-10-17T11:22:13+01:00",
  
  "author": {
    "@type": "Person",
    "name": "Lisa DeBruine"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Lisa DeBruine",
    "logo": {
      "@type": "ImageObject",
      "url": "https://debruine.github.io/media/icon_hud41de7153c7fa400a999f8d222dc5c78_8091_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "I saw this a few days ago and sympathised, because I’ve often wanted to use data that is trapped in images or PDFs. If it’s not too much, I’ll manually transcribe it, but that’s so tedious!"
}
</script>

  

  

  

  

  <title>Data from Images | Lisa DeBruine</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="a4107fefe445bcf744dade19e5ee7868" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.8988fb2a4bba758785868cfcb5244555.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container-xl">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Lisa DeBruine</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Lisa DeBruine</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#publications"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#talks"><span>Talks</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

      
      
        
          
          <li class="nav-item d-none d-lg-inline-flex">
            <a class="nav-link" href="/"  aria-label="">
              <i class="fas fa-" aria-hidden="true"></i>
            </a>
          </li>
        
      

      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      
      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Data from Images</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
          Last updated on
      
    
    2021-10-17
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    8 min read
  </span>
  

  
  
  
  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/category/rstats/">rstats</a></span>
  

</div>

    





  
</div>



  <div class="article-container">

    <div class="article-style">
      
<script src="https://debruine.github.io/post/data-from-images/index_files/header-attrs/header-attrs.js"></script>
<script src="https://debruine.github.io/post/data-from-images/index_files/kePrint/kePrint.js"></script>
<link href="https://debruine.github.io/post/data-from-images/index_files/lightable/lightable.css" rel="stylesheet" />


<p>I saw this a few days ago and sympathised, because I’ve often wanted to use data that is trapped in images or PDFs. If it’s not too much, I’ll manually transcribe it, but that’s so tedious!</p>
<blockquote class="twitter-tweet">
<p lang="en" dir="ltr">
crucial data being published as images … 😭😭😭😭 <a href="https://t.co/9CKg9NhYtA">https://t.co/9CKg9NhYtA</a>
</p>
— Shel 🇰🇪 (<span class="citation">@Shel_Kariuki</span>) <a href="https://twitter.com/Shel_Kariuki/status/1449029768763084814?ref_src=twsrc%5Etfw">October 15, 2021</a>
</blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>A tweet by <a href="https://twitter.com/abiyugiday/status/1449257787821789184?s=20">Abiyu Giday</a> reminded me that the <code>magick</code> package has OCR (optical character recognition), so I decided to try it out.</p>
<div id="required-packages" class="section level3">
<h3>Required packages</h3>
<pre class="r"><code>library(magick)    # for image processing
library(tesseract) # for OCR image reading
library(dplyr)     # for data wrangling and pipes
library(tidyr)     # for data wrangling
library(stringr)   # for string manipulation
library(ggplot2)   # for plots</code></pre>
</div>
<div id="read-the-image" class="section level3">
<h3>Read the image</h3>
<p>First, you need to read in the image and convert it to text using two functions from the <a href="https://cran.r-project.org/web/packages/magick/vignettes/intro.html"><code>magick</code></a> package.</p>
<p>I use <a href="https://imagemagick.org/">ImageMagick</a> for webmorph development, so had it installed previously. I’m not sure if installing the R package also sets up the ImageMagick installation. If you’re on a Windows machine, the easiest way is to use <code>installr::install.imagemagick()</code>. On a Mac, you can install it with <a href="https://brew.sh/">Homebrew</a> using <code>brew install imagemagick@6</code>.</p>
<p>Now You can read in the image with <code>image_read()</code> and run OCR on it with <code>image_ocr()</code>. If you haven’t installed the <code>tesseract</code> package yet, the second function will prompt you to.</p>
<pre class="r"><code># original image source:
# https://pbs.twimg.com/media/FBv8P8XXEBgCBvS?format=jpg&amp;name=medium
imgtext &lt;- magick::image_read(&quot;data_image.jpg&quot;) %&gt;%
  magick::image_ocr()</code></pre>
</div>
<div id="process-the-text" class="section level3">
<h3>Process the text</h3>
<p>The result is a single <a class='glossary' target='_blank' title='A data type representing strings of text.' href='https://psyteachr.github.io/glossary/c#character'>character</a> string that looks like this, so we’re going to need to do quite a bit of processing to get it into a <a class='glossary' target='_blank' title='Data in a rectangular table format, where each row has an entry for each column.' href='https://psyteachr.github.io/glossary/t#tabular-data'>tabular</a> format.</p>
<pre>
rs
COUNTY VACCINES AL |

1. Nairobi 957,147 (31.4%) 25. Homa Bay 33,290 (5.5%)
2. Kiambu 298,723 (18.4%) 26. Migori 32,670 (5.9%)
3. Nakuru 170,684 (13.4%) 27. Kilifi 31,611 (4.0%)
4. Nyeri 134,166 (26.3%) 28. Kisii 30,204 (4.3%)
5. Murang’a 110,825 (16.4%) 29. Nyamira 29,142 (8.5%)
6. Machakos 100,671 (11.1%) 30. Busia 26,792 (5.8%)
7. Uasin Gishu 92,142 (13.3%) 31. Vihiga 25,172 (7.6%)
8. Kisumu 90,495 (13.8%) 32. Tharaka Nithi 24,386 (9.9%)
9. Mombasa 82,814 (10.3%) 33. Baringo 21,176 (6.2%)
10. Kirinyaga 81,233 (19.6%) 34. Bomet 20,885 (4.5%)
ll. Kajiado 75,960 (11.5%) 35. Elgeyo Marakwet 17,574 (7.2%)
12. Bungoma 66,688 (7.9%) 36. Kwale 17,185 (3.8%)
13. Meru 66,270 (7.0%) 37. Narok 15,410 (2.8%)
14. Kakamega 62,043 (6.3%) 38. Turkana 9,249 (2.0%)
15. Nyandarua 60,574 (16.1%) 39. West Pokot 8,207 (2.9%)
16. Laikipia 58,141 (19.0%) 40. Garissa 7,694 (1.9%)
17. Makueni 57,435 (9.8%) 41. Samburu 6,686 (4.6%)
18. Embu 56,082 (14.2%) 42. Mandera 6,220 (1.8%)
19. Trans Nzoia 45,228 (8.7%) 43. Isiolo 5,653 (4.2%)
20. Kitui 40,663 (6.5%) 44. Wajir 5,003 (1.5%)
21. Kericho 38,497 (7.6%) 45. Lamu 4,692 (5.6%)
22. Siaya 38,313 (7.1%) 46. Tana River 3,440 (2.3%)
23. Nandi 38,243 (7.8%) 47. Marsabit 2,953 ( 1.3%)
24. Taita Taveta 34,478 (16.2%)

</pre>
<p>First, I’ll get rid of the first three lines.</p>
<p>You need to put two backslashes before the <code>"\\|"</code> to mark it as a literal <code>|</code>, since <code>|</code> has a special meaning in regular expressions (it means “or”). This is called <a class='glossary' target='_blank' title='Include special characters like " inside of a string by prefacing them with a backslash.' href='https://psyteachr.github.io/glossary/e#escape'>escaping</a> the character. The combination <code>"\n"</code> represents a line break.</p>
<pre class="r"><code>trimmed &lt;- gsub(&quot;rs\nCOUNTY VACCINES AL \\|\n\n&quot;, &quot;&quot;, imgtext)

trimmed</code></pre>
<pre><code>## [1] &quot;1. Nairobi 957,147 (31.4%) 25. Homa Bay 33,290 (5.5%)\n2. Kiambu 298,723 (18.4%) 26. Migori 32,670 (5.9%)\n3. Nakuru 170,684 (13.4%) 27. Kilifi 31,611 (4.0%)\n4. Nyeri 134,166 (26.3%) 28. Kisii 30,204 (4.3%)\n5. Murang’a 110,825 (16.4%) 29. Nyamira 29,142 (8.5%)\n6. Machakos 100,671 (11.1%) 30. Busia 26,792 (5.8%)\n7. Uasin Gishu 92,142 (13.3%) 31. Vihiga 25,172 (7.6%)\n8. Kisumu 90,495 (13.8%) 32. Tharaka Nithi 24,386 (9.9%)\n9. Mombasa 82,814 (10.3%) 33. Baringo 21,176 (6.2%)\n10. Kirinyaga 81,233 (19.6%) 34. Bomet 20,885 (4.5%)\nll. Kajiado 75,960 (11.5%) 35. Elgeyo Marakwet 17,574 (7.2%)\n12. Bungoma 66,688 (7.9%) 36. Kwale 17,185 (3.8%)\n13. Meru 66,270 (7.0%) 37. Narok 15,410 (2.8%)\n14. Kakamega 62,043 (6.3%) 38. Turkana 9,249 (2.0%)\n15. Nyandarua 60,574 (16.1%) 39. West Pokot 8,207 (2.9%)\n16. Laikipia 58,141 (19.0%) 40. Garissa 7,694 (1.9%)\n17. Makueni 57,435 (9.8%) 41. Samburu 6,686 (4.6%)\n18. Embu 56,082 (14.2%) 42. Mandera 6,220 (1.8%)\n19. Trans Nzoia 45,228 (8.7%) 43. Isiolo 5,653 (4.2%)\n20. Kitui 40,663 (6.5%) 44. Wajir 5,003 (1.5%)\n21. Kericho 38,497 (7.6%) 45. Lamu 4,692 (5.6%)\n22. Siaya 38,313 (7.1%) 46. Tana River 3,440 (2.3%)\n23. Nandi 38,243 (7.8%) 47. Marsabit 2,953 ( 1.3%)\n24. Taita Taveta 34,478 (16.2%)\n&quot;</code></pre>
</div>
<div id="split-into-rows" class="section level3">
<h3>Split into rows</h3>
<p>Since there are two rows of data on each row, I’ll convert all of the line breaks (<code>"\n"</code>) into spaces and then split the result wherever there is 0 or 1 spaces (<code>" ?"</code>), followed by 1 or more digits (<code>"[0-9]+"</code>), followed by a full stop and a space (<code>"\\. "</code>).</p>
<pre class="r"><code>split_base &lt;- gsub(&quot;\n&quot;, &quot; &quot;, trimmed) %&gt;%
  strsplit(&quot; ?[0-9]+\\. &quot;)</code></pre>
<p>If you prefer <code>stringr</code> functions to base functions, you can do it this way:</p>
<pre class="r"><code>split_stringr &lt;- trimmed %&gt;%
  stringr::str_replace(&quot;\n&quot;, &quot; &quot;) %&gt;%
  stringr::str_split(&quot; ?s[0-9]+\\. &quot;)</code></pre>
</div>
<div id="fix-encoding-errors" class="section level3">
<h3>Fix encoding errors</h3>
<p>Make sure you look through all of your data at this point. The first time I did this, I didn’t notice that <code>11.</code> got read in as <code>ll.</code>, so line 21 didn’t split.</p>
<pre class="r"><code>split_base[[1]][21]</code></pre>
<pre><code>## [1] &quot;Bomet 20,885 (4.5%) ll. Kajiado 75,960 (11.5%)&quot;</code></pre>
<p>You can fix that by replacing <code>"ll. "</code> with <code>"11. "</code> before you split the data.</p>
<pre class="r"><code>split_base &lt;- trimmed %&gt;%
  gsub(&quot;ll. &quot;, &quot;11. &quot;, .) %&gt;%
  gsub(&quot;\n&quot;, &quot; &quot;, .) %&gt;%
  strsplit(&quot; ?[0-9]+\\. &quot;)</code></pre>
</div>
<div id="tabular-format" class="section level3">
<h3>Tabular format</h3>
<p>Now we need to get this into a tabular format. The objects <code>split_base</code> and <code>split_stringr</code> are 1-item <a class='glossary' target='_blank' title='A container data type that allows items with different data types to be grouped together.' href='https://psyteachr.github.io/glossary/l#list'>lists</a> where the first item contains the <a class='glossary' target='_blank' title='A type of data structure that collects values with the same data type, like T/F values, numbers, or strings.' href='https://psyteachr.github.io/glossary/v#vector'>vector</a> of our rows. The first row is blank (the content before the first split at <code>1.</code>) so we have to omit that. The code below creates a data frame.</p>
<pre class="r"><code>data1 &lt;- data.frame(x = split_base[[1]][-1]) </code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Nairobi 957,147 (31.4%)
</td>
</tr>
<tr>
<td style="text-align:left;">
Homa Bay 33,290 (5.5%)
</td>
</tr>
<tr>
<td style="text-align:left;">
Kiambu 298,723 (18.4%)
</td>
</tr>
<tr>
<td style="text-align:left;">
Migori 32,670 (5.9%)
</td>
</tr>
<tr>
<td style="text-align:left;">
Nakuru 170,684 (13.4%)
</td>
</tr>
<tr>
<td style="text-align:left;">
Kilifi 31,611 (4.0%)
</td>
</tr>
</tbody>
</table>
</div>
<div id="separate-columns" class="section level3">
<h3>Separate columns</h3>
<p>Now we have to separate the columns out. There are several ways to do this. If you’re a regex wizard, you don’t need the rest of this tutorial, so I’m going to break it into smaller steps instead. Using <code>gsub()</code> to create new columns by replacing parts of the original column is a straightforward way (HT <a href="https://twitter.com/_TanHo">Tan Ho</a>).</p>
<p>Create the <code>county</code> column by replacing all characters from the space before the first digit (<code>[0-9]</code>) plus any characters after that (<code>.*</code>) until the end of the string (<code>$</code>). Create the <code>number</code> column by replacing from the start of the string (<code>^</code>) plus any non-numbers (<code>[^0-9]+</code>) that follow it.</p>
<pre class="r"><code>data2 &lt;- data1 %&gt;%
  mutate(county = gsub(&quot; [0-9].*$&quot;, &quot;&quot;, x),
         number = gsub(&quot;^[^0-9]+&quot;, &quot;&quot;, x))</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
x
</th>
<th style="text-align:left;">
county
</th>
<th style="text-align:left;">
number
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Nairobi 957,147 (31.4%)
</td>
<td style="text-align:left;">
Nairobi
</td>
<td style="text-align:left;">
957,147 (31.4%)
</td>
</tr>
<tr>
<td style="text-align:left;">
Homa Bay 33,290 (5.5%)
</td>
<td style="text-align:left;">
Homa Bay
</td>
<td style="text-align:left;">
33,290 (5.5%)
</td>
</tr>
<tr>
<td style="text-align:left;">
Kiambu 298,723 (18.4%)
</td>
<td style="text-align:left;">
Kiambu
</td>
<td style="text-align:left;">
298,723 (18.4%)
</td>
</tr>
<tr>
<td style="text-align:left;">
Migori 32,670 (5.9%)
</td>
<td style="text-align:left;">
Migori
</td>
<td style="text-align:left;">
32,670 (5.9%)
</td>
</tr>
<tr>
<td style="text-align:left;">
Nakuru 170,684 (13.4%)
</td>
<td style="text-align:left;">
Nakuru
</td>
<td style="text-align:left;">
170,684 (13.4%)
</td>
</tr>
<tr>
<td style="text-align:left;">
Kilifi 31,611 (4.0%)
</td>
<td style="text-align:left;">
Kilifi
</td>
<td style="text-align:left;">
31,611 (4.0%)
</td>
</tr>
</tbody>
</table>
<p>The <code>county</code> column looks fine, but the <code>number</code> column needs to be split into the number of vaccinations and the percent. Use the <code>separate()</code> function to split this column on the left parenthesis (remember to <a class='glossary' target='_blank' title='Include special characters like " inside of a string by prefacing them with a backslash.' href='https://psyteachr.github.io/glossary/e#escape'>escape</a> it).</p>
<pre class="r"><code>data3 &lt;- data2 %&gt;%
  separate(col = number, 
           into = c(&quot;number&quot;, &quot;percent&quot;), 
           sep = &quot;\\(&quot;,
           extra = &quot;drop&quot;) </code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
x
</th>
<th style="text-align:left;">
county
</th>
<th style="text-align:left;">
number
</th>
<th style="text-align:left;">
percent
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Nairobi 957,147 (31.4%)
</td>
<td style="text-align:left;">
Nairobi
</td>
<td style="text-align:left;">
957,147
</td>
<td style="text-align:left;">
31.4%)
</td>
</tr>
<tr>
<td style="text-align:left;">
Homa Bay 33,290 (5.5%)
</td>
<td style="text-align:left;">
Homa Bay
</td>
<td style="text-align:left;">
33,290
</td>
<td style="text-align:left;">
5.5%)
</td>
</tr>
<tr>
<td style="text-align:left;">
Kiambu 298,723 (18.4%)
</td>
<td style="text-align:left;">
Kiambu
</td>
<td style="text-align:left;">
298,723
</td>
<td style="text-align:left;">
18.4%)
</td>
</tr>
<tr>
<td style="text-align:left;">
Migori 32,670 (5.9%)
</td>
<td style="text-align:left;">
Migori
</td>
<td style="text-align:left;">
32,670
</td>
<td style="text-align:left;">
5.9%)
</td>
</tr>
<tr>
<td style="text-align:left;">
Nakuru 170,684 (13.4%)
</td>
<td style="text-align:left;">
Nakuru
</td>
<td style="text-align:left;">
170,684
</td>
<td style="text-align:left;">
13.4%)
</td>
</tr>
<tr>
<td style="text-align:left;">
Kilifi 31,611 (4.0%)
</td>
<td style="text-align:left;">
Kilifi
</td>
<td style="text-align:left;">
31,611
</td>
<td style="text-align:left;">
4.0%)
</td>
</tr>
</tbody>
</table>
</div>
<div id="clean-up-the-data" class="section level3">
<h3>Clean up the data</h3>
<p>Now we just need to clean up some extra characters in the <code>number</code> and <code>percent</code> columns. Get rid of the comma in the <code>number</code> column and the percent sign and right parenthesis in the <code>percent</code> column (remember to escape the parenthesis).</p>
<pre class="r"><code>data4 &lt;- data3 %&gt;%
  mutate(number = gsub(&quot;,&quot;, &quot;&quot;, number),
         percent = gsub(&quot;%\\)&quot;, &quot;&quot;, percent)) %&gt;%
  select(-x)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
county
</th>
<th style="text-align:left;">
number
</th>
<th style="text-align:left;">
percent
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Nairobi
</td>
<td style="text-align:left;">
957147
</td>
<td style="text-align:left;">
31.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Homa Bay
</td>
<td style="text-align:left;">
33290
</td>
<td style="text-align:left;">
5.5
</td>
</tr>
<tr>
<td style="text-align:left;">
Kiambu
</td>
<td style="text-align:left;">
298723
</td>
<td style="text-align:left;">
18.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Migori
</td>
<td style="text-align:left;">
32670
</td>
<td style="text-align:left;">
5.9
</td>
</tr>
<tr>
<td style="text-align:left;">
Nakuru
</td>
<td style="text-align:left;">
170684
</td>
<td style="text-align:left;">
13.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Kilifi
</td>
<td style="text-align:left;">
31611
</td>
<td style="text-align:left;">
4.0
</td>
</tr>
</tbody>
</table>
</div>
<div id="check-data-types" class="section level3">
<h3>Check data types</h3>
<p>This looks good, but there is still a problem. We can’t do anything useful with this data set because the <code>number</code> and <code>percent</code> columns are actually still character <a class='glossary' target='_blank' title='The kind of data represented by an object.' href='https://psyteachr.github.io/glossary/d#data-type'>data types</a>.</p>
<pre class="r"><code>summary(data4)</code></pre>
<pre><code>##     county             number            percent         
##  Length:47          Length:47          Length:47         
##  Class :character   Class :character   Class :character  
##  Mode  :character   Mode  :character   Mode  :character</code></pre>
<pre class="r"><code>m &lt;- mean(data4$number)</code></pre>
<pre><code>## Warning in mean.default(data4$number): argument is not numeric or logical:
## returning NA</code></pre>
<p>Convert the <code>number</code> column to an <a class='glossary' target='_blank' title='A data type representing whole numbers.' href='https://psyteachr.github.io/glossary/i#integer'>integer</a> and the <code>percent</code> column to a <a class='glossary' target='_blank' title='A data type representing a real decimal number' href='https://psyteachr.github.io/glossary/d#double'>double</a>.</p>
<pre class="r"><code>data &lt;- data4 %&gt;%
  mutate(number = as.integer(number),
         percent = as.double(percent))</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
county
</th>
<th style="text-align:right;">
number
</th>
<th style="text-align:right;">
percent
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Nairobi
</td>
<td style="text-align:right;">
957147
</td>
<td style="text-align:right;">
31.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Homa Bay
</td>
<td style="text-align:right;">
33290
</td>
<td style="text-align:right;">
5.5
</td>
</tr>
<tr>
<td style="text-align:left;">
Kiambu
</td>
<td style="text-align:right;">
298723
</td>
<td style="text-align:right;">
18.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Migori
</td>
<td style="text-align:right;">
32670
</td>
<td style="text-align:right;">
5.9
</td>
</tr>
<tr>
<td style="text-align:left;">
Nakuru
</td>
<td style="text-align:right;">
170684
</td>
<td style="text-align:right;">
13.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Kilifi
</td>
<td style="text-align:right;">
31611
</td>
<td style="text-align:right;">
4.0
</td>
</tr>
</tbody>
</table>
<p>Now you’re ready to plot the data or use it in analyses.</p>
<pre class="r"><code>ggplot(data, aes(x = number, y = percent)) +
  geom_point(color = &quot;dodgerblue&quot;) +
  scale_x_continuous(&quot;Number of Vaccinated People&quot;,
                     breaks = seq(0, 1e6, 2e5),
                     labels = c(paste0(seq(0, 800, 200), &quot;K&quot;), &quot;1M&quot;),
                     limits = c(0, 1e6)) +
  scale_y_continuous(&quot;Percent of County&quot;,
                     breaks = seq(0, 40, 10),
                     labels = paste0(seq(0, 40, 10), &quot;%&quot;)) +
  theme_bw()</code></pre>
<p><img src="https://debruine.github.io/post/data-from-images/index_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
<div id="glossary" class="section level3">
<h3>Glossary</h3>
<table>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:left;">
definition
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/c.html#character" class="glossary" target="_blank">character</a>
</td>
<td style="text-align:left;">
A data type representing strings of text.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/d.html#data-type" class="glossary" target="_blank">data type</a>
</td>
<td style="text-align:left;">
The kind of data represented by an object.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/d.html#double" class="glossary" target="_blank">double</a>
</td>
<td style="text-align:left;">
A data type representing a real decimal number
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/e.html#escape" class="glossary" target="_blank">escape</a>
</td>
<td style="text-align:left;">
Include special characters like " inside of a string by prefacing them with a backslash.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/i.html#integer" class="glossary" target="_blank">integer</a>
</td>
<td style="text-align:left;">
A data type representing whole numbers.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/l.html#list" class="glossary" target="_blank">list</a>
</td>
<td style="text-align:left;">
A container data type that allows items with different data types to be grouped together.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/t.html#tabular-data" class="glossary" target="_blank">tabular data</a>
</td>
<td style="text-align:left;">
Data in a rectangular table format, where each row has an entry for each column.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://psyteachr.github.io/glossary/v.html#vector" class="glossary" target="_blank">vector</a>
</td>
<td style="text-align:left;">
A type of data structure that collects values with the same data type, like T/F values, numbers, or strings.
</td>
</tr>
</tbody>
</table>
</div>

    </div>

    






<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/r/">R</a>
  
  <a class="badge badge-light" href="/tag/data/">data</a>
  
  <a class="badge badge-light" href="/tag/wrangling/">wrangling</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://debruine.github.io/post/data-from-images/&amp;text=Data%20from%20Images" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://debruine.github.io/post/data-from-images/&amp;t=Data%20from%20Images" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Data%20from%20Images&amp;body=https://debruine.github.io/post/data-from-images/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://debruine.github.io/post/data-from-images/&amp;title=Data%20from%20Images" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=Data%20from%20Images%20https://debruine.github.io/post/data-from-images/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://debruine.github.io/post/data-from-images/&amp;title=Data%20from%20Images" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="https://debruine.github.io/"><img class="avatar mr-3 avatar-circle" src="/author/lisa-debruine/avatar_hu54e598e07dd250d156b952ca12280398_226968_270x270_fill_q75_lanczos_center.jpg" alt="Lisa DeBruine"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://debruine.github.io/">Lisa DeBruine</a></h5>
      <h6 class="card-subtitle">Professor of Psychology</h6>
      <p class="card-text">Lisa DeBruine is a professor of psychology at the University of Glasgow. Her substantive research is on the social perception of faces and kinship. Her meta-science interests include team science (especially the Psychological Science Accelerator), open documentation, data simulation, web-based tools for data collection and stimulus generation, and teaching computational reproducibility.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/" >
        <i class="fas fa-"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/debruine" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://tech.lgbt/@debruine" target="_blank" rel="noopener">
        <i class="fab fa-mastodon"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.co.uk/citations?user=oLHcVYUAAAAJ" target="_blank" rel="noopener">
        <i class="fas fa-graduation-cap"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://osf.io/4i578/" target="_blank" rel="noopener">
        <i class="ai ai-osf"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://figshare.com/authors/Lisa_DeBruine/3235773" target="_blank" rel="noopener">
        <i class="ai ai-figshare"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="http://orcid.org/0000-0002-7523-5539" target="_blank" rel="noopener">
        <i class="ai ai-orcid"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
    <li>
      <a href="mailto:lisa.debruine@glasgow.ac.uk" >
        <i class="far fa-paper-plane"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>
















  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/post/experimentum-data/">Experimentum Data Wrangling Demo</a></li>
      
      <li><a href="/post/loops/">Loops</a></li>
      
      <li><a href="/post/normality/">Testing for normality</a></li>
      
      <li><a href="/post/mann-whitney/">Mann-Whitney False Positives</a></li>
      
      <li><a href="/post/how-many-sims/">How many simulations in my power analysis?</a></li>
      
    </ul>
  </div>
  





  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  



  

  

  

  
  





  
  
  
  

  
  
  
    
  

  

  
  <p class="powered-by copyright-license-text">
    This work is licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0" rel="noopener noreferrer" target="_blank">CC BY SA 4.0</a>
  </p>
  

  <p class="powered-by footer-license-icons">
    <a href="https://creativecommons.org/licenses/by-sa/4.0" rel="noopener noreferrer" target="_blank" aria-label="Creative Commons">
      <i class="fab fa-creative-commons fa-2x" aria-hidden="true"></i>
      <i class="fab fa-creative-commons-by fa-2x" aria-hidden="true"></i>
      
      
        <i class="fab fa-creative-commons-sa fa-2x" aria-hidden="true"></i>
      
    </a>
  </p>




  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> — the free, <a href="https://github.com/wowchemy/wowchemy-hugo-modules" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    <script src="/js/vendor-bundle.min.b73dfaac3b6499dc997741748a7c3fe2.js"></script>

    
    
    
      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      
      

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/python.min.js" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/latex.min.js" crossorigin="anonymous"></script>
        
      

    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js" integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin="anonymous"></script>
    

    
    

    
    
    
      
      <script id="search-hit-fuse-template" type="text/x-template">
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
      
    

    
    

    
    
    
    

    
    
      
      
      
      
      
      
      
    

    
    
    
    
    
    
    
    
      
      
    
    
    <script src="/en/js/wowchemy.min.d68ecd57c0ec1f1f61d65fd568f1c3a0.js"></script>

    
  <script async defer src="https://buttons.github.io/buttons.js"></script>




</body>
</html>
